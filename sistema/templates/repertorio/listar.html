{% extends "base.html" %}

{% block titulo %} Listagem de veículos {% endblock %}

{% block conteudo %}
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<style>
/* ----- GERAL E CABEÇALHO ----- */
body {
    background-color: #F5F0EA; /* Cor de fundo bege claro da página */
    color: #10224F;            /* Cor de texto padrão (azul escuro) */
    font-family: 'Inter', sans-serif;
}

/* Ajusta o header que vem do base.html */
header {
    border-bottom: 1px solid #EAEAEA;
    background-color: #F5F0EA;
}

.nav-link {
    color: #3B507C !important; /* Cor dos links do menu */
    font-weight: 500;
}

/* Botão de Logout */
.col-md-3 .btn-secondary {
    background-color: #10224F !important;
    border: none;
    border-radius: 8px;
    font-weight: 600;
}

/* Badge "Admin" */
.btn-secondary .badge {
    background-color: #E0C590 !important; /* Cor de fundo amarela */
    color: #192A51 !important;            /* Cor do texto */
    top: 110% !important;                 /* Posiciona abaixo do botão */
    left: 50%;
    transform: translateX(-50%);
    padding: 3px 8px;
    font-size: 0.7rem;
    font-weight: 600;
}


/* ----- ÁREA DE BUSCA ----- */
.busca {
    background: transparent; /* Remove o fundo cinza da busca */
    padding: 0;
}

.busca input[type="text"].form-control {
    background-color: #F4F1EA; /* Cor de fundo do campo de pesquisa */
    border: 1px solid #E0D9CE;
    border-radius: 8px;
    color: #192A51;
    padding: 10px 15px;
}

.busca input[type="text"].form-control::placeholder {
    color: #6c757d; /* Cor do placeholder */
}

.busca .btn-primary {
    background-color: #10224F; /* Cor do botão "Procurar" */
    border: none;
    border-radius: 8px;
    font-weight: 600;
    padding: 10px 20px;
}

/* ----- QUANTIDADE DE VEÍCULOS ----- */
p.fw-semibold {
    color: #192A51;
    font-size: 1rem;
    margin-top: 1.5rem;
}

/* Transforma o badge numérico em texto normal */
p.fw-semibold .badge {
    background-color: transparent !important;
    color: inherit !important;
    font-size: inherit;
    font-weight: inherit;
    padding-left: 5px;
}

/* ----- CARD DE VEÍCULO ----- */
.card {
    background-color: #F5F0EA; /* Cor de fundo do card */
    border-radius: 20px;
    border: 1px solid #E0D9CE;
    box-shadow: 0 4px 15px rgba(0,0,0,0.06);
    overflow: hidden; /* Garante que elementos internos respeitem a borda */
    padding: 2rem !important;
    max-width: 500px; /* Largura máxima para centralizar e parecer com a imagem */
    margin: 0 auto;   /* Centraliza o card na coluna */
}

/* Bloco da imagem placeholder */
.card .bg-light.text-secondary {
    background-color: #D9D9D9 !important; /* Cor cinza do placeholder */
    color: transparent !important;        /* Esconde o texto original "Veículo sem foto" */
    font-size: 0;                         /* Garante que o texto suma */
    position: relative;
    height: 180px !important;             /* Aumenta a altura da imagem */
    width: 100%;
    max-width: 200px;
    margin: 0 auto;
}

/* Adiciona o texto "Foto do Veículo" via CSS */
.card .bg-light.text-secondary::before {
    content: "Foto do Veículo";
    color: #585858;
    font-size: 1rem;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Título (Modelo e Marca) */
.card-title {
    color: #10224F; /* Cor da MARCA */
    font-weight: 700;
    font-size: 1.25rem;
    text-align: center;
    margin-top: 1.5rem;
    line-height: 1.2;
}

/* Adiciona o texto "Modelo" acima da marca */
.card-title::before {
    content: "Modelo";
    display: block;
    color: #192A51; /* Cor do texto "Modelo" */
    font-weight: 400;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

/* Detalhes do veículo (Ano, Cor, etc.) */
.card-body .col-8.col-md-6 {
    text-align: left;
    margin-top: 1rem;
}
.card-body p {
    text-align: left;
    color: #192A51;
}

/* Botões de Ação (Editar e Apagar) */
.card .text-md-end {
    display: flex;
    justify-content: flex-end; /* Alinha os botões à direita */
    gap: 0.75rem; /* Espaçamento entre os botões */
    align-items: center;
    margin-top: 1rem;
}

/* Estilo comum para os dois botões */
.btn-outline-primary, .btn-outline-danger {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    font-size: 0; /* Esconde o texto original ("Editar", "Apagar") */
    border: none !important;
    position: relative;
    color: white !important;
}

/* Adiciona os ícones usando Font Awesome (que já está no base.html) */
.btn-outline-primary::before, .btn-outline-danger::before {
    font-family: "Font Awesome 6 Free";
    font-weight: 900;
    font-size: 1rem;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Botão de Editar */
.btn-outline-primary {
    background-color: #EAC88B !important; /* Cor amarela do botão */
}
.btn-outline-primary::before {
    content: '\f044'; /* Ícone de lápis (editar) */
}

/* Botão de Apagar */
.btn-outline-danger {
    background-color: #D67474 !important; /* Cor vermelha do botão */
}
.btn-outline-danger::before {
    content: '\f2ed'; /* Ícone de lixeira */
}
</style>

<div class="container mt-4">
    <div class="busca mb-4">
        <form method="get" class="d-flex">
            <input type="text" name="busca" class="form-control me-2" 
                   placeholder="Procurar" value="{{ request.GET.busca }}">
            <button class="btn btn-primary" type="submit">Procurar</button>
        </form>
    </div>

    <p class="fw-semibold mb-3">Quantidade de veículos: 
        <span class="badge bg-primary">{{ lista_veiculos|length }}</span>
    </p>

    <div class="row g-3">
        {% for veiculo in lista_veiculos %}
        <div class="col-12">
            <div class="card p-3">
                <div class="row g-3 align-items-center">
                    <div class="col-4 col-md-3">
                        {% if veiculo.foto %}
                            <img src="{{ veiculo.foto.url }}" 
                                 class="img-fluid rounded" 
                                 alt="Foto do veículo" 
                                 style="object-fit: cover; width: 100%; height: 120px;">
                        {% else %}
                            <div class="d-flex align-items-center justify-content-center bg-light text-secondary rounded" 
                                 style="height:120px; font-size:0.9rem;">
                                Veículo sem foto
                            </div>
                        {% endif %}
                    </div>

                    <div class="col-8 col-md-6">
                        <h5 class="card-title mb-1">
                            {{ veiculo.get_marca_display }} {{ veiculo.modelo }}
                        </h5>
                        <p class="mb-1"><strong>Ano:</strong> {{ veiculo.ano }}</p>
                        <p class="mb-1"><strong>Cor:</strong> {{ veiculo.get_cor_display }}</p>
                        <p class="mb-0"><strong>Combustível:</strong> {{ veiculo.get_combustivel_display }}</p>
                    </div>

                    <div class="col-12 col-md-3 text-md-end mt-2 mt-md-0">
                        <a class="btn btn-sm btn-outline-primary me-2">
                            Editar
                        </a>
                        <a class="btn btn-sm btn-outline-danger" onclick="return confirm('Tem certeza que deseja apagar este veículo?')">
                            Apagar
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-info text-center">
                Nenhum veículo cadastrado.
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
